<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate.dls Chatroom</title>
<style>
  /* RESET & BASE */
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f7fa; color: #333; }
  a { text-decoration: none; color: inherit; }

  /* HEADER */
  header { background: linear-gradient(90deg,#2c3e50,#4c5c70); color: #fff; padding: 20px; text-align: center; position: relative; }
  header h1 { font-size: 1.8em; margin-bottom: 10px; }
  nav a { margin: 0 12px; font-weight: 600; transition: 0.3s; }
  nav a:hover { color: #f39c12; }

  /* LOGOUT BUTTON */
  #logoutBtn { position: absolute; right: 20px; top: 20px; background: #e74c3c; color: white; border: none; padding: 8px 15px; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.3s; }
  #logoutBtn:hover { background: #c0392b; }

  /* CONTAINER */
  .container { max-width: 800px; margin: 30px auto; background: #fff; padding: 25px; border-radius: 15px; box-shadow: 0 6px 18px rgba(0,0,0,0.1); }

  /* BLOG INFO */
  .blog-info { margin-bottom: 25px; text-align: center; }
  .blog-info h2 { font-size: 1.8em; margin-bottom: 12px; color: #2c3e50; }
  .blog-info p { color: #555; line-height: 1.6; }

  /* CHAT BOX */
  #chat-box { height: 450px; overflow-y: auto; border-radius: 12px; background: #f9f9f9; padding: 15px; border: 1px solid #ddd; }
  .chat-message { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; padding: 10px; background: #edf2f7; border-radius: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.05); }
  .chat-message img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }
  .chat-message strong { color: #2c3e50; }
  .timestamp { font-size: 0.75em; color: #7f8c8d; margin-left: 8px; }

  /* CHAT FORM */
  #chat-form { display: flex; gap: 12px; margin-top: 15px; flex-wrap: wrap; }
  #message { flex: 1; padding: 12px; border-radius: 10px; border: 1px solid #ccc; font-size: 1em; }
  #send-btn { padding: 12px 20px; border: none; background: #2c3e50; color: white; font-weight: bold; border-radius: 10px; cursor: pointer; transition: 0.3s; }
  #send-btn:hover { background: #34495e; }

  /* LOGIN MODAL */
  .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); justify-content: center; align-items: center; z-index: 10; }
  .modal-content { background: #fff; padding: 30px; border-radius: 15px; text-align: center; width: 90%; max-width: 380px; box-shadow: 0 6px 18px rgba(0,0,0,0.15); }
  .modal-content input { width: 100%; margin-bottom: 15px; padding: 12px; border-radius: 10px; border: 1px solid #ccc; font-size: 1em; }
  .modal-content button { width: 100%; padding: 12px; border-radius: 10px; font-weight: bold; border: none; background: #2c3e50; color: white; transition: 0.3s; margin-bottom: 10px; cursor: pointer; }
  .modal-content button:hover { background: #34495e; }

  /* RESPONSIVE */
  @media(max-width:600px){
    header h1 { font-size: 1.4em; }
    nav a { display: block; margin: 6px 0; }
    #chat-form { flex-direction: column; }
  }
</style>
</head>
<body>

<header>
  <h1>Ultimate.dls Chatroom</h1>
  <nav>
<nav class="nav">
  <a href="index.html">Home</a>
  <a href="blog.html">Blog</a>
  <a href="match.html">Matches</a>
  <a href="tables.html">Tables</a>
  <a href="login.html">Login</a>
  <a href="signup.html">Sign Up</a>
</nav>

  </nav>
  <button id="logoutBtn" style="display:none;">Logout</button>
</header>

<div class="container">
  <div class="blog-info">
    <h2>Welcome to Ultimate.dls Community!</h2>
    <p>Discuss DLS strategies, post-match reactions, and share your Ultimate Team progress with others. Stay connected and updated with league highlights in real time.</p>
  </div>

  <div id="chat-box"></div>
  <form id="chat-form">
    <input type="text" id="message" placeholder="Type your message..." required>
    <button type="submit" id="send-btn">Send</button>
  </form>
</div>

<!-- LOGIN MODAL -->
<div class="modal" id="loginModal">
  <div class="modal-content">
    <h2>Login to Ultimate.dls Chat</h2>
    <input type="email" id="email" placeholder="Email" required>
    <input type="password" id="password" placeholder="Password" required>
    <button id="loginBtn">Login</button>
    <p>Don't have an account?</p>
    <button id="signupBtn">Sign Up</button>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyBdK_tiTsYhX27IsdjBnBRJ1a-4Eanoe8g",
    authDomain: "ultimatedlschat.firebaseapp.com",
    databaseURL: "https://ultimatedlschat-default-rtdb.firebaseio.com",
    projectId: "ultimatedlschat",
    storageBucket: "ultimatedlschat.firebasestorage.app",
    messagingSenderId: "485655960703",
    appId: "1:485655960703:web:b6a97068cf5ebf1e98734a",
    measurementId: "G-SDE2YCCMZW"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.database();

  const chatBox = document.getElementById('chat-box');
  const chatForm = document.getElementById('chat-form');
  const messageInput = document.getElementById('message');
  const loginModal = document.getElementById('loginModal');
  const logoutBtn = document.getElementById('logoutBtn');
  let currentUser = null;

  function formatTime(timestamp){
    const d = new Date(timestamp);
    let h = d.getHours();
    const m = d.getMinutes().toString().padStart(2,'0');
    const ampm = h>=12?'PM':'AM';
    h = h%12 || 12;
    return `${h}:${m} ${ampm}`;
  }

  auth.onAuthStateChanged(user=>{
    if(user){
      currentUser=user;
      loginModal.style.display='none';
      logoutBtn.style.display='block';
      loadMessages();
    } else {
      loginModal.style.display='flex';
      logoutBtn.style.display='none';
    }
  });

  logoutBtn.onclick=()=>auth.signOut();

  document.getElementById('loginBtn').onclick=async()=>{
    const email=document.getElementById('email').value;
    const password=document.getElementById('password').value;
    try{ await auth.signInWithEmailAndPassword(email,password); alert('Logged in!'); } 
    catch(e){ alert(e.message); }
  }

  document.getElementById('signupBtn').onclick=async()=>{
    const email=document.getElementById('email').value;
    const password=document.getElementById('password').value;
    try{ await auth.createUserWithEmailAndPassword(email,password); alert('Account created!'); } 
    catch(e){ alert(e.message); }
  }

  function loadMessages(){
    const messagesRef=db.ref('messages');
    messagesRef.off();
    messagesRef.on('child_added',snap=>{
      const msg=snap.val();
      const div=document.createElement('div');
      div.classList.add('chat-message');
      div.innerHTML=`<strong>${msg.username||"Anonymous"}:</strong> ${msg.text} <span class="timestamp">${formatTime(msg.timestamp)}</span>`;
      chatBox.appendChild(div);
      chatBox.scrollTop=chatBox.scrollHeight;
    });
  }

  chatForm.addEventListener('submit',e=>{
    e.preventDefault();
    if(!currentUser)return alert('Login first!');
    const text=messageInput.value.trim();
    if(!text)return;
    const username=currentUser.email.split('@')[0];
    db.ref('messages').push({username,text,timestamp:Date.now()});
    messageInput.value='';
  });
</script>
</body>
</html>
